# Aggregating local descriptors into a compact image representation



我们在非常大的规模上解决图像搜索的问题，其中必须共同考虑三个约束条件：搜索的准确性、效率和表示的内存使用。

我们首先提出了一种简单而有效的方法，将局部图像描述符聚合为一个有限维数的向量，这可以看作是 *Fisher*核表示的一种简化。

然后我们展示如何联合优化降维和索引算法，以最好地保持向量比较的质量。

评估表明，我们的方法明显优于最新技术：对于适合20个字节的图像表示，搜索精度与特征包方法相当。搜索一个1000万个图像数据集大约需要50个ms。

# 1.Introduction

特征包图像表示(BOF)在索引和分类应用中很受欢迎，有两个原因。

首先，这种表示受益于强大的本地描述符，如SIFT描述符[12]和最近的[13,28,29]。其次，这些向量表示可以用标准距离进行比较，然后被支持向量机等鲁棒分类方法使用。

当用于大规模图像搜索时，表示图像的BOF向量被有利地选择为高维的[16,20,10]，高达100万维。

在这种情况下，搜索效率来自于使用反向列表[23]，它加快了稀疏向量之间距离的计算。

然而，有两个因素限制了在实践中可以索引的图像数量：搜索本身的效率，当考虑超过1000万张图像时，这变得禁止，以及表示图像所需的内存。

在本文中，我们解决了在一个非常大的图像数据库（1000万张或更多的图像）中搜索最相似的图像的问题。我们强调了三个约束条件的联合优化：搜索精度、搜索效率和内存使用量。最后两个是相关的[24]，因为搜索效率可以近似于要访问的内存量。

与我们的工作最相似的是[9]的方法，它提出了一种对BOF向量的近似最近邻搜索。然而，这种方法仅限于小词汇量，搜索精度较低。此外，一个图像仍然需要超过100个字节来重现一个相对较低的搜索精度的低维BOF向量。

最小哈希方法[2,3]和托雷萨尼等人的[25]方法部分解决了效率问题。然而，这些技术仍然需要每幅图像大量的内存，并在接近重复的图像检测的背景下是更相关的，因为它们的搜索精度明显低于BOF。一些作者通过使用GIST描述符[17]，并将它们转换为压缩的二进制向量[5,11,24,27]来解决效率和内存限制。这些方法受到全局GIST描述符的低不变性的限制，并且没有一种方法共同满足上述三个约束条件：[24,27]仍然需要穷举搜索，而[11]由于LSH算法的冗余性而消耗内存。

 相比之下，我们的方法通常通过20字节的表示获得了显著更高的精度。这是通过优化而获得的：

1. 表示法，即如何将局部图像描述符聚合为一个向量表示法
2. 这些向量的降维方法；
3. 索引算法。

这些步骤密切相关：用高维向量表示图像通常比用低维向量提供更好的穷举搜索结果。然而，高维向量更难有效地索引。相比之下，低维向量更容易被索引，但其鉴别能力较低，可能不足以识别物体或场景。

我们的第一个贡献在于提出了一种表示，该表示提供了具有合理的向量维数的优秀搜索精度，因为我们知道该向量将随后被索引。

我们提出了一个描述符，由BOF和Fisher核[18]导出的描述符，它聚合了SIFT描述符并产生一个紧凑的表示。

它被称为VLAD（局部聚合描述符的向量）。实验结果表明，在相同尺寸下，VLAD的性能显著优于BOF。它的计算成本较低，通过主成分分析(PCA)可以将其维数降低到几百个分量，而不会显著影响其精度

作为第二个贡献，我们展示了联合优化降维和索引算法之间的权衡的优势。我们特别考虑了[7]最近的索引方法，因为我们可以直接比较由PCA引起的误差和由索引引起的误差，这是由于从其编码的索引近似重建的向量。

在展示了启发我们的两种图像向量表示，BOF和Fisher核[18]之后，我们在第2节中介绍了我们的描述符聚合方法。降维和索引的联合优化。

实验结果证明了我们的方法在第4节的性能：我们证明了BOF的性能是通过一个大约20个字节的图像表示来实现的。在内存使用、搜索准确性和效率方面，这都是对最先进的[9]的一个显著改进。



# 2. Image vector representation