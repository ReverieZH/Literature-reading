# Learning attention-guided pyramidal features for few-shot fine-grained recognition

few-shot细粒度识别(FS-FGR)的目的是在有限的监督条件下，从不同的子类别中区分出几个高度相似的对象。

然而，传统的少镜头学习解决方案通常利用图像级的特征，并致力于捕获全局轮廓，而意外地忽略了探索局部细节，导致不可避免的不明显但可区分的信息丢失问题。

因此，如何在有限的样本条件下有效地解决细粒度识别问题仍然是一个主要的挑战。

在本文中，我们倾向于提出一种有效的**双向金字塔体系结构**来增强特征的内部表示，以满足少镜头学习场景中的细粒度图像识别任务。

具体来说，我们在主干网络上部署了一个多尺度的特征金字塔和一个多层次的注意金字塔，并通过它们两者逐步聚合来自不同粒度空间的特征。

然后，我们进一步提出了一种注意导向的细化策略与一个多层次的注意力金字塔合作，以减少背景条件带来的不确定性

此外，该方法在元学习框架下以端到端方式进行训练，没有任何额外的监督。在四个具有挑战性和广泛使用的细粒度基准测试上的广泛实验结果表明，所提出的方法优于最先进的技术，特别是在one-shot场景中

# **1. Introduction**

细粒度识别，又称子类别识别，旨在在同一超类别下区分属于不同子类别的对象，这已经引起了研究界的广泛关注。

由于类内的高和类间的低方差，细粒度识别的主要任务是区分细微的视觉差异（如不同种类的鸟类），这比一般的物体识别更具挑战性。

近年来，随着卷积神经网络(CNNs)的快速发展和对视觉语义特征的强大学习能力，本研究取得了很大的进展[1-3]。不幸的是，两个主要的限制仍然没有得到解决，这使得许多现有的工作在现实应用程序中不那么实际和可伸缩。

首先，传统的工作[4,5]通常依赖于额外的注释（例如，边界框或部分注释），而预定义的手动注释通常需要专家提供特定领域的知识，这是非常耗时和成本消耗的

第二，几乎所有基于深度学习的模型[6,7]都严重依赖于大规模标记良好的训练数据，以有监督的方式进行学习。收集数据是一项非常劳动密集型的任务。更糟糕的是，我们无法获得一些特殊类别的足够的训练样本，比如濒危物种和医学图像。

人们一致认为，与机器相比，人类具有从一个或几个例子中学习的非凡能力。

在此的激励下，少镜头学习成为一种有效的解决方案，以缓解对大规模注释数据的挑战性需求。

.在这种情况下，研究人员更关注如何学习一个良好的广义模型来识别给定的一些样本的新的视觉类别，这也促进了元学习的出现。在本文中，我们将研究在一个更实际的少镜头设置中的细粒度识别问题，其中只有少数甚至一个标记样本可用。

少镜头细粒度识别(FS-FGR)是由Wei等人的[8]首次提出的，这是一种以前几乎很少有工作探索过的新任务。毫无疑问，FS-FGR不仅继承了一般的少镜头学习(FSL)任务的难度，而且在细粒度识别任务中还必须面临新的难点。

FS-FGR非常具有挑战性的主要原因有三个：

（1）低类间方差和高类内方差。细粒度数据集的一个自然特点是，属于同一子类别的对象通常会出现明显不同，而属于不同子类别的对象可能非常相似;

（2）有限数据机制。被标记的样本不足以区分在新的子类别中存在的细微的视觉差异；

（3）集群背景。杂乱的背景倾向于反对对象的存在，并在FS-FGR任务中发挥负面作用。

总之，FS-FGR的目标是充分利用可访问的标记数据来提高模型的泛化和表示能力，以满足细粒度的识别任务。

FS-FGR的关键是学习区分性特征，以区分低数据机制下的细微的视觉差异。因此，直接使用现有的FSL算法来解决FS-FGR问题是不合理的，尽管这些方法在一般的图像分类中已经取得了令人印象深刻的性能。

大多数现有的FSL算法[9–12]通常将从网络的最后一层提取的卷积池化全局特征视为图像级表示。例如，在最具代表性的基于度量学习的方法中，高级特征被直接用于通过最近邻分类器进行分类。

很明显，这些具有全局概念的深度全局特征不能为细粒度的对象捕获相当多的有区别的局部信息，特别是在低数据状态中。低级别信息可能是进一步提高性能的适当选择。

![image-20220726233250415](E:\Literature-reading\Recent deveopments of CBIR\40 SCDA\image-20220726233250415.png)

图1显示了不同层中特征激活的差异。可以观察到，高级特征包含全局语义信息，而低级特征包含局部详细信息。在现有的方法中，利用一些常见的实践（如注意机制）来加强主导对象和增强鉴别特征，而多尺度表示在对细粒度对象的上下文理解中探索较少。因此，我们能够通过增强的高级和低级信息的协作，从各种子类别中区分出几个高度相似的对象。

在本研究中，我们将所提出的方法制定为一个两阶段的元学习范式，它结合了多层次特征学习和注意导向前景细化，构建了FS-FGR的注意导向金字塔特征。所提框架的概述架构如图2所示。

![image-20220726233703116](E:\Literature-reading\Recent deveopments of CBIR\40 SCDA\image\image-20220726233703116.png)

该方法分别分为粗化阶段和细化阶段两个阶段。粗阶段主要获得目标的整体特征和信息前景区域。细化阶段，包括裁剪机制，以原始图像的放大版本作为输入，研究具有可分辨性更强、冗余性更少的细粒度特征。

考虑到由于粗阶段的错误定位，被注意的细化结果只是目标的一部分，我们连接了两个阶段的输出嵌入，以提高元嵌入对相似性计算的鲁棒性。为了证明所提出的模型的优越性，在四个具有挑战性和广泛使用的细粒度基准测试上进行了广泛的实验。我们的工作的主要贡献总结如下：

- 我们提出了一个两阶段的元学习框架，包括一个粗阶段和一个精炼阶段来学习注意力引导的金字塔细粒度识别(FSFGR)任务。特别是，该方法可以在没有任何额外监督的情况下进行端到端的优化。据我们所知，这是第一个成功开发的利用特征金字塔网络到FS-FGR任务模型的范式。
- 我们提出在我们的模型中联合利用一个多尺度的特征金字塔(MSFP)和一个多层次的注意金字塔(MLAP)。两者都可以插入到任何主干网络中，形成双向金字塔结构，用于从不同的粒度中提取不同的特征，然后将其进行整合，得到FS-FGR的最终相似性度量

- 为了进一步提高金字塔特征的性能，提出了一种注意导向的细化策略来增强主导对象，消除背景的负干扰。这种策略允许网络分离前景和背景，而不需要边界框/部分注释。

- 在多个细粒度基准数据集上的大量实验结果表明，所提出的注意引导金字塔特征可以有效地显著提高FSFGR的精度。

本文的其余部分组织如下。第二节介绍了一些关于少镜头学习和细粒度识别的相关工作。在第4节中提供了关于所提出的方法的每个组成部分的细节。接下来，我们分析了第5节和第6节的实验，总结了本文。